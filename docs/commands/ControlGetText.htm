<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>ControlGetText</title>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<link href="../css/default.css" rel="stylesheet" type="text/css">
</head>
<body>

<h1>ControlGetText</h1>

<p>Ermittelt den Text eines Steuerelements. </p>

<pre class="Syntax">ControlGetText, AusgabeVar [, Steuerelement, Fenstertitel, Fenstertext, Titelausnahme, Textausnahme]</pre>
<h3>Parameter</h3>
<dl>

  <dt>AusgabeVar</dt>
  <dd><p>Name der Variable, in der der ermittelte Text gespeichert werden soll.</p>    </dd>

  <dt>Steuerelement</dt>
  <dd><p>Kann entweder das ClassNN (Klassenname und Instanznummer des Steuerelements) oder der Text des Steuerelements sein, das beides mit Windows Spy ermittelt werden kann. Verwendet man Text, ist das Übereinstimmungsverhalten abhängig von <a href="SetTitleMatchMode.htm">SetTitleMatchMode</a>. Ist dieser Parameter leer oder nicht vorhanden, wird das oberste Steuerelement des Fensters benutzt.</p>
    <p>To operate upon a control's HWND (window handle), leave the <em>Control</em> parameter blank and specify <code>ahk_id %ControlHwnd%</code> for the <em>WinTitle</em> parameter (this also works on hidden controls even when <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> is Off) . The HWND of a control is typically retrieved via <a href="ControlGet.htm#Hwnd">ControlGet Hwnd</a>, <a href="MouseGetPos.htm">MouseGetPos</a>, or <a href="DllCall.htm">DllCall</a>.</p></dd>

  <dt>Fenstertitel</dt>
  <dd><p>Ein Fenstertitel oder sonstige Kriterien, die das Zielfenster ermitteln sollen. Siehe <a href="../misc/WinTitle.htm">Fenstertitel</a>.</p></dd>

  <dt>Fenstertext</dt>
  <dd><p>In diesem Parameter kann ein Teilstring angegeben werden, der in einem Textelement des Zielfensters vorkommt (abrufbar mit Windows Spy). Versteckte Textelemente werden auch erkannt, sofern <a href="DetectHiddenText.htm">DetectHiddenText</a> aktiv ist.</p></dd>

  <dt>Titelausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Titel diesen Wert enthalten.</p></dd>

  <dt>Textausnahme</dt>
  <dd><p>Ignoriert Fenster, deren Textelemente diesen Wert enthalten.</p></dd>

</dl>

<h3>ErrorLevel</h3>
<p>This command is able to throw an exception on failure. For more information, see <a href="Catch.htm#RuntimeErrors">Runtime Errors</a>.</p>
<p><a href="../misc/ErrorLevel.htm">ErrorLevel</a> wird bei Misserfolg auf 1 und bei Erfolg auf 0 gesetzt.</p>
<h3>Bemerkungen</h3>
<p>Hinweis: Um Text aus einem ListView-, ListBox- oder ComboBox-Steuerelement zu ermitteln, verwende stattdessen <a href="ControlGet.htm#List">ControlGet List</a>.</p>
<p>Erscheint der ermittelte Text gekürzt (unvollständig), muss <code><a href="VarSetCapacity.htm">VarSetCapacity(AusgabeVar, 55)</a></code> vor ControlGetText verwenden werden [55 sollte durch eine wesentlich größere Zahl als die Länge des Textes ersetzt werden]. Das ist notwendig, weil einige Anwendungen nicht richtig auf die WM_GETTEXTLENGTH-Nachricht reagieren, wodurch AutoHotkey AusgabeVar zu klein macht, so dass der ganzen Text nicht mehr reinpasst.</p>
<p>This command might use a large amount RAM if the target control (e.g. an editor with a large document open) contains a large quantity of text. However, a variable's memory can be freed after use by assigning it to nothing, i.e. <code>OutputVar := ""</code></p>
<p>Meistens enthält der abgerufene Text eines Steuerelements CR- und LF-Zeichen (`r`n), anstatt ein einzelnes LF-Zeichen (`n), um das Ende jeder Zeile zu kennzeichnen.</p>
<p>Es ist nicht notwendig, <code>SetTitleMatchMode Slow</code> zu verwenden, weil ControlGetText den Text immer mithilfe der langsamen Methode ermittelt (da bei dieser Methode die Chance höher ist, dass der Befehl bei den meisten Steuerelementarten funktioniert).</p>
<p>Mit <a href="WinGet.htm#ControlList">WinGet ControlList</a> kann eine Liste mit Steuerelementen von einem Fenster abgerufen werden.</p>
<p>Fenstertitel und -texte unterscheiden zwischen Groß- und Kleinschreibung. Solange <a href="DetectHiddenWindows.htm">DetectHiddenWindows</a> deaktiviert ist, werden versteckte Fenster nicht wahrgenommen.</p>
<h3>Siehe auch</h3>
<p><a href="ControlSetText.htm">ControlSetText</a>, <a href="WinGetText.htm">WinGetText</a>, <a href="Control.htm">Control</a>, <a href="ControlGet.htm">ControlGet</a>, <a href="ControlMove.htm">ControlMove</a>, <a href="ControlFocus.htm">ControlFocus</a>, <a href="ControlClick.htm">ControlClick</a>, <a href="ControlSend.htm">ControlSend</a></p>
<h3>Beispiel</h3>
<pre class="NoIndent">ControlGetText, AusgabeVar, Edit1, Unbenannt -</pre>

</body>
</html>
