<!DOCTYPE HTML>
<html>
<head>
<title>MsgBox</title>
<meta name="description" content="Zeigt auf einfache Weise ein Hinweisfenster in dieser freien Script-Sprache an. Außerdem kann man benutzerdefinierte Dateneingabefenster, Benutzeroberflächen und Menüleisten erstellen.">
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="robots" content="noindex, nofollow">
<link href="../static/theme.css" rel="stylesheet" type="text/css" />
<script src="../static/jquery.js" type="text/javascript"></script>
<script src="../static/tree.jquery.js" type="text/javascript"></script>
<script src="../static/ga.js" type="text/javascript"></script>
<script src="../static/content.js" type="text/javascript"></script>
</head>
<body>

<h1>MsgBox</h1>

<p>Zeigt den angegebenen Text in einem kleinen Fenster an, das einen oder mehrere Buttons enthält (z. B. Ja und Nein).</p>

<pre class="Syntax">MsgBox, Text
MsgBox [, Optionen, Titel, Text, Zeitüberschreitung]</pre>
<h3>Parameter</h3>
<dl>

  <dt>Text</dt>
  <dd><p>Falls alle Parameter weggelassen werden, wird die MsgBox "Press OK to continue." anzeigen. Ansonsten kann mit diesem Parameter der Text innerhalb der MsgBox bestimmt werden, um den Benutzer zu unterweisen oder Informationen darzustellen.</p>
    <p><a href="../misc/EscapeChar.htm">Escapesequenzen</a> können verwendet werden, um besondere Zeichen zu kennzeichnen. Zum Beispiel kennzeichnet `n ein Zeilenumbruchszeichen, das die aktuelle Zeile beendet und eine neue beginnt. Folglich würde mit Text1`n`nText2 eine leere Zeile zwischen Text1 und Text2 erzeugt.</p>
    <p>Falls der <em>Text</em> zu lang ist, kann er in mehreren kurzen Zeilen aufgeteilt werden (<a href="../Scripts.htm#continuation">Fortsetzungsbereich</a>), um ihn besser lesbar und verwaltbar zu machen.</p></dd>

  <dt>Optionen</dt>
  <dd><p>Bestimmt den Typ der MsgBox und mögliche Buttons. Ist dieser Parameter leer oder nicht vorhanden, wird standardmäßig eine 0 verwendet. Siehe untere Tabelle für zulässige Werte.</p>
    <p>Dieser Parameter muss entweder eine literale Zahl oder ein erzwungener Ausdruck wie <em>% Optionen</em> sein. Andere nicht-leere Werte werden nicht als diesen Parameter erkannt, sondern als <em>Text</em> im Einzelparametermodus.</p></dd>

  <dt>Titel</dt>
  <dd><p>Der Titel der MsgBox. Ist dieser Parameter leer oder nicht vorhanden, wird standardmäßig der aktuelle Name des Scripts verwendet (ohne Pfad).</p></dd>

  <dt>Zeitlimit</dt>
  <dd><p><a name="Timeout"></a>(Optional) Zeitlimit in Sekunden, das einen Dezimalpunkt enthalten kann. Überschreitet dieser Wert 2.147.483 (24,8 Tage), wird er automatisch auf 2.147.483 zurückgesetzt. Sobald die Zeit abgelaufen ist, wird die MsgBox automatisch geschlossen und <a href="#Result">A_MsgBoxResult</a> den Wert "Timeout" enthalten.</p>
      <p>Bekannte Einschränkung: Wenn die MsgBox nur einen OK-Button enthält, kennzeichnet <a href="#Result">A_MsgBoxResult</a>, dass der OK-Button bei Zeitüberschreitung gedrückt wurde, während ihr eigener <a href="../misc/Threads.htm">Thread</a> von einem anderen unterbrochen worden ist.</p></dd>

</dl>

<p>Der <em>Optionen</em>-Parameter kann folgende Werte enthalten, einzeln oder summiert.</p>
<table class="info" style="width:55%">
  <tr>
    <th width="287">Funktion</th>
    <th>Dezimal-Wert</th>
    <th>Hex-Wert</th>
  </tr>
  <tr>
    <td>OK</td>
    <td align="center">0</td>
    <td align="center">0x0</td>
  </tr>
  <tr>
    <td>OK/Abbrechen</td>
    <td align="center">1</td>
    <td align="center">0x1</td>
  </tr>
  <tr>
    <td>Abbrechen / Wiederholen / Ignorieren</td>
    <td align="center">2</td>
    <td align="center">0x2</td>
  </tr>
  <tr>
    <td>Ja / Nein / Abbrechen</td>
    <td align="center">3</td>
    <td align="center">0x3</td>
  </tr>
  <tr>
    <td>Ja / Nein</td>
    <td align="center">4</td>
    <td align="center">0x4</td>
  </tr>
  <tr>
    <td>Wiederholen / Abbrechen</td>
    <td align="center">5</td>
    <td align="center">0x5</td>
  </tr>
  <tr>
    <td>Abbrechen / Wiederholen / Weiter</td>
    <td align="center">6</td>
    <td align="center">0x6</td>
  </tr>
  <tr>
    <td>Hilfe-Button hinzufügen (siehe Bemerkungen)</td>
    <td align="center">16384</td>
    <td align="center">0x4000</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td>Icon Hand (Stopp / Fehler)</td>
    <td align="center">16</td>
    <td align="center">0x10</td>
  </tr>
  <tr>
    <td>Icon Fragezeichen</td>
    <td align="center">32</td>
    <td align="center">0x20</td>
  </tr>
  <tr>
    <td>Icon Ausrufezeichen</td>
    <td align="center">48</td>
    <td align="center">0x30</td>
  </tr>
  <tr>
    <td>Icon Sternchen (Info)</td>
    <td align="center">64</td>
    <td align="center">0x40</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td>Zweiten Button zum Standard-Button machen</td>
    <td align="center">256</td>
    <td align="center">0x100</td>
  </tr>
  <tr>
    <td>Dritten Button zum Standard-Button machen</td>
    <td align="center">512</td>
    <td align="center">0x200</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td>System Modal (immer im Vordergrund)</td>
    <td align="center">4096</td>
    <td align="center">0x1000</td>
  </tr>
  <tr>
    <td>Task Modal</td>
    <td align="center">8192</td>
    <td align="center">0x2000</td>
  </tr>
  <tr>
    <td>Immer im Vordergrund (WS_EX_TOPMOST-Style)<br>
      (Wie System Modal, aber ohne Icon in der Titelleiste)</td>
    <td align="center">262144</td>
    <td align="center">0x40000</td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td align="center">&nbsp;</td>
    <td align="center">&nbsp;</td>
  </tr>
  <tr>
    <td>Text rechtsbündig machen</td>
    <td align="center">524288</td>
    <td align="center">0x80000</td>
  </tr>
  <tr>
    <td>Leserichtung von links nach rechts (für Hebräisch / Arabisch)</td>
    <td align="center">1048576</td>
    <td align="center">0x100000</td>
  </tr>
</table>

<h3 id="Result">Ergebnis</h3>
<p>Die integrierte Variable <em>A_MsgBoxResult</em> gibt einen der folgenden Strings zurück, der den gerade gedrückten Button repräsentiert:</p>
<p>OK<br>
Cancel (Abbrechen)<br>
Yes (Ja)<br>
No (Nein)<br>
Abort (Abbrechen)<br>
Retry (Wiederholen)<br>
Ignore (Ignorieren)<br>
TryAgain (Wiederholen)<br>
Continue (Weiter)<br>
Timeout (wenn MsgBox die Zeit überschreitet)</p>

<h3>Bemerkungen</h3>
<p>Die Werte in der oberen Tabelle können addiert werden, um mehrere Eigenschaften zu kombinieren. Zum Beispiel bewirkt die Angabe von 260 (256 + 4) in den <em>Optionen</em>, dass die Buttons Ja und Nein in der MsgBox angezeigt werden und Nein zum Standard-Button gemacht wird. In Hexadezimal wäre das 0x104 (0x100 + 0x4).</p>
<p>MsgBox hat eine intelligente Komma-Handhabung, daher müssen Kommas im <em>Text</em>-Parameter nicht mit einem <a href="../misc/EscapeChar.htm">Escapezeichen</a> versehen werden.</p>
<p>Mit <a href="#Result">A_MsgBoxResult</a>-Variable kann festgestellt werden, welchen Button der Benutzer in der aktuellsten MsgBox gedrückt hat. Zum Beispiel:</p>
<pre>MsgBox, 4,, Möchten Sie fortfahren? (Ja oder Nein drücken)
if A_MsgBoxResult = "Yes"
    MsgBox Sie haben Ja gedrückt.
else
    MsgBox Sie haben Nein gedrückt.</pre>
<p>Die Namen der Buttons können mit <a href="../scripts/MsgBoxButtonNames.htm">diesem Beispiel</a> geändert werden.</p>
<p><strong>Tipp</strong>: Der Text einer aktiven MsgBox kann mit STRG+C in die Zwischenablage kopiert werden. Das gilt für alle Fenster dieser Art, nicht nur für solche, die von AutoHotkey erstellt wurden.</p>
<p><strong>MsgBox mit einem GUI-Fenster verwenden</strong>: Ein GUI-Fenster kann eine <em>modale</em> MsgBox mithilfe von <a href="Gui.htm#OwnDialogs">Gui, +OwnDialogs</a> darstellen. Solange ein <em>modales</em> Dialogfenster offen ist, kann der Benutzer nicht mit dem GUI-Fenster interagieren. In einem solchen Fall ist es nicht notwendig, System Modal oder Task Modal in den Optionen anzugeben.</p>
<p>Wenn <a href="Gui.htm#OwnDialogs">Gui +OwnDialogs</a> <em>nicht</em> aktiv ist, kann die Option Task Modal (8192) dazu verwendet werden, alle Fenster des Scripts zu deaktivieren, solange die MsgBox offen ist.</p>
<p><strong>Der Hilfe-Button</strong>: Sobald die entsprechende Option (83) in den <em>Optionen</em> vorhanden ist, wird ein Hilfe-Button angezeigt, der aber nur funktioniert, wenn die beiden folgenden Bedingungen erfüllt sind:</p>
<ol>
  <li>Die MsgBox wurde einem GUI-Fenster mittels <a href="Gui.htm#OwnDialogs">Gui +OwnDialogs</a> untergeordnet.</li>
  <li>Das Script überwacht die WM_HELP-Nachricht (0x53). Zum Beispiel: <code><a href="OnMessage.htm">OnMessage(0x53, "WM_HELP")</a></code>. Beim Aufrufen der Funktion WM_HELP() kann zum Beispiel ein weiteres Fenster angezeigt werden, um den Benutzer zusätzliche Hinweise mitzuteilen.</li>
</ol>
<p><strong>Der Schließen-Button (in der Titelleiste der MsgBox)</strong>: Da die MsgBox ein integriertes Feature vom Betriebssystem ist, wird ihr <strong>X</strong>-Button nur aktiv sein, wenn bestimmte Buttons vorhanden sind. Gibt es nur einen OK-Button, ist das Anklicken von <strong>X</strong> das gleiche wie, als würde man OK drücken. Ansonsten ist der X-Button deaktiviert. Wenn aber ein Abbrechen-Button verfügbar ist, wäre das Anklicken von <strong>X</strong> das gleiche wie, als würde man Abbrechen drücken.</p>
<h3>Siehe auch</h3>
<p><a href="InputBox.htm">InputBox</a>, <a href="FileSelect.htm">FileSelect</a>, <a href="DirSelect.htm">DirSelect</a>, <a href="ToolTip.htm">ToolTip</a>, <a href="Gui.htm">GUI</a></p>
<h3>Beispiel</h3>
<h4>Funktionssyntax</h4><pre class="NoIndent">MsgBox("Das ist die 1-Parameter-Methode. Wenn nur ein einziger Parameter übergeben wird, ist der erste Parameter die Nachricht.")

MsgBox(64, "3-Parameter-Methode", "Der erste Parameter bestimmt den Typ der MsgBox.`n" 
	. "Der zweite Parameter ist der Fenstertitel.`n"
	. "Der dritte Parameter ist die Nachricht.")

MsgBox(4, "", "Möchten Sie fortfahren? (JA oder NEIN drücken)
if A_MsgBoxResult = "No"
    return
MsgBox(4, "4-Parameter-Methode", "Diese MsgBox wird in 5 Sekunden automatisch geschlossen.  Weiter?", 5)
if A_MsgBoxResult = "Timeout"
    MsgBox("Sie haben innerhalb der 5 Sekunden weder auf JA noch auf NEIN gedrückt.")
else if A_MsgBoxResult = "No"
    return</pre><pre class="NoIndent"><em>; Füge eine Variable ein und führe eine mathematische Berechung in der Nachricht durch.</em>
var := 10
Msgbox("Der Anfangswert ist: " var)
MsgBox("Das Ergebnis ist: " var * 2)</pre>
<h4>Befehlssyntax</h4><pre class="NoIndent">MsgBox Das ist die 1-Parameter-Methode. Kommas (,) müssen nicht mit einem Escapezeichen versehen werden.

MsgBox, 64
	, 3-Parameter-Methode
	, Dies ist die 3-Parameter-Methode. Kommas (,) müssen nicht mit einem Escapezeichen versehen werden.

MsgBox, 4, , Möchten Sie fortfahren? (JA oder NEIN drücken)
if A_MsgBoxResult = "No"
    return

MsgBox, 4, , 4-Parameter-Methode: Diese MsgBox wird in 5 Sekunden automatisch geschlossen.  Weiter?, 5
if A_MsgBoxResult = "Timeout"
    MsgBox Sie haben innerhalb der 5 Sekunden weder auf JA noch auf NEIN gedrückt.
else if A_MsgBoxResult = "No"
    return</pre><pre class="NoIndent"><em>; Füge eine Variable in die Nachricht ein.</em>
var := 10
MsgBox Der Anfangswert ist: %var	<em>; Das vorangestellte % ermöglicht die Ausgabe des Variableninhalts.</em>
MsgBox % "Das Ergebnis ist: " var * 2	<em>; Durch Voranstellen von "% " wird jeder Parameter zu einem Ausdruck.</em></pre>
</body>
</html>
